# .github/workflows/test-runner.yml
name: Test Self-Hosted Runner

on:
  workflow_dispatch  # Manual trigger for testing

jobs:
  test-connectivity:
    runs-on: self-hosted  # Uses your runner
    
    steps:
      - name: Check Runner Environment
        shell: powershell
        run: |
          Write-Host "Runner is working!"
          Write-Host "Hostname: $(hostname)"
          Write-Host "User: $(whoami)"
          Write-Host "PowerShell Version: $($PSVersionTable.PSVersion)"
          
      - name: Test Jenkins Connectivity
        shell: powershell 
        run: |
          Write-Host "Testing Jenkins connectivity..."
          try {
              Write-Host "Testing with curl.exe..."
              $curlResult = curl.exe -I --connect-timeout 10 --max-time 30 http://svttstif001:9092 2>&1
              if ($LASTEXITCODE -eq 0) {
                  Write-Host "[OK] curl.exe: Jenkins is reachable"
                  Write-Host $curlResult
              } else {
                  Write-Host "[ERROR] curl.exe: Cannot reach Jenkins"
                  Write-Host $curlResult
              }
          } catch {
              Write-Host "[ERROR] curl.exe error: $($_.Exception.Message)"
          }
